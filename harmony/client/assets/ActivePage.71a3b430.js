import{_ as p,u as I,d as C,e as w,b as d,s as f,l as m,P as i,C as B,c as a,a as s,n as L,t as g,f as S,g as x,F as b,r as F,h as A,o as r,i as y,A as c,j as M,p as N,k as P}from"./index.87b405aa.js";import{l as _}from"./LikesService.47c60f37.js";const V={setup(){const n=I(),t=C();async function v(){try{await f.findSongById(n.params.songId)}catch(o){m.error(o),i.error(o.message)}}async function e(){try{await A.getCommentsBySongId(n.params.songId)}catch(o){i.error(o.message)}}async function k(){try{await _.getLikesBySongId(n.params.songId)}catch(o){i.error(o.message),m.log(o)}}return w(()=>{v(),e(),k()}),{route:n,songs:d(()=>c.songs),song:d(()=>c.activeSong),account:d(()=>c.account),comments:d(()=>c.comments),likes:d(()=>c.myLikes),foundMe:d(()=>c.likes.find(o=>o.accountId==c.account.id)),async deleteSong(){try{await f.deleteSong(n.params.songId),t.push({name:"Home"})}catch(o){m.error(o),i.error(o.message)}},async likeSong(){try{await _.likeSong({songId:n.params.songId})}catch(o){m.error(o),i.error(o.message)}},async removeLike(o){try{await _.removeLike(o)}catch(u){m.error(u),i.error(u.message)}}}},components:{CommentForm:B}},R=n=>(N("data-v-7addd2bb"),n=n(),P(),n),j={class:"container-fluid"},z={key:0,class:"col-12"},D={class:"d-flex pb-2"},E=["src"],H={class:"row m-2 align-items-center"},T={class:"col-12"},q={class:"row"},G={class:"p-4 card"},J=["src"],K=y(),O=R(()=>s("button",{class:"btn btn-danger col-1"},[s("i",{class:"mdi mdi-delete"}),y(" delete")],-1));function Q(n,t,v,e,k,o){var h;const u=M("CommentForm");return r(),a(b,null,[s("div",j,[s("div",{class:"row cover-img card",style:L("background-image: url()")},[e.song?(r(),a("div",z,[s("div",D,[s("img",{class:"img-fluid mt-2",src:e.song.coverImg,alt:""},null,8,E),s("div",H,[s("h1",null,g(e.song.name),1),s("h1",null,"Likes: "+g(e.likes.length),1),s("h1",null,"streams "+g(e.song.streams),1),s("div",T,[e.foundMe?(r(),a("i",{key:1,class:"elevation-5 mdi mdi-heart-broken fs-2 p-3 selectable bg-danger rounded my-2",onClick:t[1]||(t[1]=l=>e.removeLike(e.foundMe.id))})):(r(),a("i",{key:0,class:"elevation-5 mdi mdi-heart-outline fs-2 p-3 selectable bg-danger rounded my-2",onClick:t[0]||(t[0]=(...l)=>e.likeSong&&e.likeSong(...l))})),((h=e.song)==null?void 0:h.artistId)==e.account.id?(r(),a("button",{key:2,title:"delete song?",class:"btn btn-outline bg-danger mdi mdi-delete",onClick:t[2]||(t[2]=l=>e.deleteSong(e.song.id))})):S("",!0)])])])])):S("",!0)],4)]),s("div",q,[x(u)]),s("div",null,[(r(!0),a(b,null,F(e.comments,l=>(r(),a("div",G,[s("h4",null,[s("img",{src:e.account.picture,alt:"",class:"img-fluid comment-img elevation-3"},null,8,J),y(g(e.account.name),1)]),s("h2",null,g(l.body),1),K,O]))),256))])],64)}const X=p(V,[["render",Q],["__scopeId","data-v-7addd2bb"]]);export{X as default};
